{
  "project_name": "therness-welding-hackathon",
  "data_root": "/data1/malto/therness/data/Hackathon",
  "num_classes": 7,
  "device": "auto",
  "video": {
    "model": {
      "hidden_size": 128,
      "pretrained": true
    },
    "training": {
      "epochs": 3,
      "batch_size": 16,
      "lr": 0.0001,
      "seq_len": 15,
      "frame_skip": 5,
      "metric": "hackathon_combined",
      "class_weights": "inverse_frequency",
      "split_strategy": "group_shuffle",
      "checkpoint_path": "checkpoints/video/gru_classifier.pth"
    }
  },
  "video_window": {
    "model": {
      "pretrained": true
    },
    "training": {
      "epochs": 3,
      "batch_size": 32,
      "lr": 0.0001,
      "window_size": 8,
      "window_stride": 4,
      "metric": "hackathon_combined",
      "class_weights": "inverse_frequency",
      "split_strategy": "group_shuffle",
      "checkpoint_path": "checkpoints/video/window_classifier.pth"
    }
  },
  "audio": {
    "feature_params": {
      "sampling_rate": 16000,
      "n_fft": 1024,
      "frame_length_in_s": 0.04,
      "frame_step_in_s": 0.02,
      "n_mels": 40,
      "f_min": 0,
      "f_max": 8000,
      "chunk_length_in_s": 1.0,
      "normalize": true
    },
    "model": {
      "dropout": 0.15
    },
    "training": {
      "train_fraction": 0.08,
      "num_epochs": 1,
      "lr": 7e-05,
      "weight_decay": 3e-05,
      "lr_schedule": {
        "warmup_ratio": 0.1,
        "plateau_factor": 0.5,
        "plateau_patience": 4,
        "plateau_threshold": 0.001,
        "plateau_min_lr": 1e-06
      },
      "patience": 1,
      "val_split": 0.2,
      "seed": 42,
      "num_workers": 2,
      "task": "multiclass",
      "sequence_mil": {
        "enabled": true,
        "batch_size": 4,
        "topk_ratio_pos": 0.12,
        "topk_ratio_neg": 0.2,
        "eval_pool_ratio": 0.12,
        "auto_threshold": true,
        "threshold": 0.5,
        "good_window_weight": 0.0,
        "use_class_weights": true,
        "class_weight_power": 0.65,
        "multiclass_eval_mode": "topk_per_class",
        "use_balanced_sampler": true,
        "balanced_sampler_power": 0.35
      },
      "metric": "macro_f1",
      "checkpoint_dir": "checkpoints/compat_multiclass"
    }
  }
}